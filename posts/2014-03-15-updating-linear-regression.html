<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Updating Linear Regression Models</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
	<link rel="stylesheet" type="text/css" href="../css/syntax.css" />
        <link rel="alternate" type="application/rss+xml" title="Blog" href="../rss.xml" />
    </head>
    <body>
        <div id="content">
        <img src="../images/header.jpg" alt="header" />
        </div>
        <div id="navigation">
            <p><h2 class="rounded">Warwick Masson</h2></p>
            <p><a href="../" class="rounded">Home</a></p>
            <p><a href="../posts.html" class="rounded">Posts</a></p>
	    <p><a href="../tags.html" class="rounded">Tags</a></p>
            <p><a href="../about.html" class="rounded">About</a></p>
	    <p><a href="../rss.xml" class="rounded">RSS</a></p>
        </div>
        <div id="content"><h2>Updating Linear Regression Models</h2>

<p>On <strong>March 15, 2014</strong></p>

<p>In linear regression, given matrices X, Y, we wish to find a beta such that</p>
<pre><code>    X beta = Y</code></pre>
<p>where X = (x1, x2, …, xn)^T and Y(y1, y2, …, yn)^T. Each xi, yi, pair represents an input and its associated output. We wish to find a linear mapping from input to output, using these pairs as examples. There is a standard solution for regression, that is</p>
<pre><code>    beta = (X X^T)^-1 XY</code></pre>
<p>Suppose though we get samples one by one, and need to use the current estimate of beta at each step. In the standard solution we would have to recompute this using all the available samples.</p>
<h4 id="updating-the-model">Updating the Model</h4>
<p>There is another way though. Define</p>
<pre><code>    A = X X^T
    b = XY</code></pre>
<p>then</p>
<pre><code>    beta = A^-1 b</code></pre>
<p>by the above formula. This is useful, because we can rewrite A and b as summations, specifically.</p>
<pre><code>    A = sum X(t)X(t)^T
    b = sum X(t)Y(t)^T</code></pre>
<p>As such, to update A and b with a new sample we use the update rules</p>
<pre><code>    A = A + X(t)X(t)^T
    b = b + X(t)Y(t)^T
    beta = A^-1 b</code></pre>
<h4 id="avoiding-the-inversion">Avoiding the Inversion</h4>
<p>One issue is that we must perform an inversion to get beta. We can avoid this using a different set of equations. We use the Sherman-Morrison formula to find this equation. We let B(t) be the inverse of A(t) at time t. Then</p>
<pre><code>    B(t) = (A(t-1) + X(t)X(t)^T)^-1
         = B(t-1) - (B(t-1) X(t)X(t)^T B(t-1))/(1 + X(t)^T B(t-1) X(t))</code></pre>
<p>So we have an update rule for new sample x</p>
<pre><code>    B &lt;- B + (B x x^T B)(1 + x^T B x)</code></pre>
<p>and b can stay the same. Our beta is then</p>
<pre><code>    beta = B b</code></pre>
<p>This eliminates the costly inversion procedure. This is similar to the method used in the efficient <a href="http://machinelearning.wustl.edu/mlpapers/paper_files/LagoudakisP03.pdf">LSPI algorithm</a>. Note that the order of multiplication matters: if we update with the ordering</p>
<pre><code>    B &lt;- B - (((B x) x^T) B)(1 + x^T B x)</code></pre>
<p>then we still have an O(k^3) complexity. To avoid this, we set</p>
<pre><code>    psi = x^T B</code></pre>
<p>then</p>
<pre><code>    B = B - (B x psi)(1 + psi x)</code></pre>
<p>which will be O(k^2). So the final update takes O(k^2) and performing n updates is O(nk^2).</p>
<h4 id="python-implementation">Python Implementation</h4>
<p>I’ve implemented this in python. The code is available on <a href="http://warwickmasson.github.com/WarwickMasson/updating-linear-regression">github</a>.</p>

<p>Tags: <a href="../tags/statistics.html">statistics</a>, <a href="../tags/python.html">python</a>.</p>
</div>
        <div id="footer">
            <p>This site generated using <a href="http://jaspervdj.be/hakyll">Hakyll</a>.
            Background by <a href="http://subtlepatterns.com/cubes">Sander Ottens</a>.</p>
        </div>
    </body>
    <script type="text/javascript">

</script>
</html>
